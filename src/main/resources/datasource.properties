#MODO DESARROLLO
SQL.DEBUG = true

# ---------------------------------------------------------
#SQL.PORCENTAJE.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM (SELECT APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY APLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.PORCENTAJE.APLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA] GROUP BY APLICACION_ID

#SQL.PORCENTAJE.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL_TRAFFIC FROM (SELECT SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.PORCENTAJE.SUBAPLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA] GROUP BY SUBAPLICACION_ID

#SQL.PORCENTAJE.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM (SELECT APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY APLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.PORCENTAJE.APLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY APLICACION_ID
SQL.PORCENTAJE.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY APLICACION_ID

#SQL.PORCENTAJE.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL_TRAFFIC FROM (SELECT SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.PORCENTAJE.SUBAPLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.PORCENTAJE.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY SUBAPLICACION_ID
SQL.PORCENTAJE.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY SUBAPLICACION_ID
# ---------------------------------------------------------

#SQL.DISTRIBUCION.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM (SELECT APLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn  GROUP BY APLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(TEMP0.UP_TRAFFIC) AS UP_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DISTRIBUCION.APLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ APLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA] GROUP BY APLICACION_ID

#SQL.DISTRIBUCION.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM (SELECT SUBAPLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(TEMP0.UP_TRAFFIC) AS UP_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DISTRIBUCION.SUBAPLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ SUBAPLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA] GROUP BY SUBAPLICACION_ID

#SQL.DISTRIBUCION.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM (SELECT APLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY APLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(TEMP0.UP_TRAFFIC) AS UP_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DISTRIBUCION.APLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY APLICACION_ID
SQL.DISTRIBUCION.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY APLICACION_ID

#SQL.DISTRIBUCION.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM (SELECT SUBAPLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWN_TRAFFIC, TEMPA.UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(TEMP0.UP_TRAFFIC) AS UP_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DISTRIBUCION.SUBAPLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DISTRIBUCION.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY SUBAPLICACION_ID 
SQL.DISTRIBUCION.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, SUM(DOWN_TRAFFIC) AS DOWN_TRAFFIC, SUM(UP_TRAFFIC) AS UP_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY SUBAPLICACION_ID 

# ---------------------------------------------------------
#SQL.ANCHO.BANDA.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_DIA, 'DD-MM-YYYY') AS FECHA_DIA FROM (SELECT APLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_DIA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_DIA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_DIA, 'DD-MM-YYYY') AS FECHA_DIA FROM (
SQL.ANCHO.BANDA.APLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_DIA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ APLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_DIA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA]

#SQL.ANCHO.BANDA.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_DIA, 'DD-MM-YYYY') AS FECHA_DIA FROM (SELECT SUBAPLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_DIA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE FECHA_DIA BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_DIA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_DIA, 'DD-MM-YYYY') AS FECHA_DIA FROM ( 
SQL.ANCHO.BANDA.SUBAPLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_DIA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_DIA INDX_DN_SUBAPLICACION_DIA_ISDN) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_DIA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA]

#SQL.ANCHO.BANDA.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_HORA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_HORA, 'DD-MM-YYYY HH24') AS FECHA_HORA FROM (SELECT APLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_HORA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_HORA, 'DD-MM-YYYY HH24') AS FECHA_HORA FROM (
SQL.ANCHO.BANDA.APLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA =[FECHA]
SQL.ANCHO.BANDA.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA]

#SQL.ANCHO.BANDA.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_HORA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_HORA, 'DD-MM-YYYY HH24') AS FECHA_HORA FROM (SELECT SUBAPLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_HORA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA_HORA, 'DD-MM-YYYY HH24') AS FECHA_HORA FROM (
SQL.ANCHO.BANDA.SUBAPLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.ANCHO.BANDA.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA]
SQL.ANCHO.BANDA.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, TIME_CONEXION, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA]
# ---------------------------------------------------------
#SQL.DETALLE.PORCENTAJE.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.PORCENTAJE.APLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID)
SQL.DETALLE.PORCENTAJE.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA]  GROUP BY (APLICACION_ID)

#SQL.DETALLE.PORCENTAJE.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID)
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY (SUBAPLICACION_ID) 

#SQL.DETALLE.PORCENTAJE.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.PORCENTAJE.APLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID)

#SQL.DETALLE.PORCENTAJE.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE 
SQL.DETALLE.PORCENTAJE.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID)
# ---------------------------------------------------------

#SQL.DETALLE.DISTRIBUCION.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY APLICACION_ID ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.DOWNLINK_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TEMP0.UPLINK_TRAFFIC) AS UPLINK_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.DISTRIBUCION.APLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY APLICACION_ID 
SQL.DETALLE.DISTRIBUCION.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY APLICACION_ID 

#SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM (SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.DOWNLINK_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TEMP0.UPLINK_TRAFFIC) AS UPLINK_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.HORA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE 
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY SUBAPLICACION_ID 
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY SUBAPLICACION_ID 

#SQL.DETALLE.DISTRIBUCION.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM ( SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY APLICACION_ID ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM ( SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.APLICACION_ID), SUM(TEMP0.DOWNLINK_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TEMP0.UPLINK_TRAFFIC) AS UPLINK_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.DISTRIBUCION.APLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.APLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY APLICACION_ID

#SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM (SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY SUBAPLICACION_ID) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.DOWN_TRAFFIC, TEMPB.UP_TRAFFIC FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.DOWNLINK_TRAFFIC AS DOWN_TRAFFIC, TEMPA.UPLINK_TRAFFIC AS UP_TRAFFIC FROM ( SELECT DISTINCT(TEMP0.SUBAPLICACION_ID), SUM(TEMP0.DOWNLINK_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TEMP0.UPLINK_TRAFFIC) AS UPLINK_TRAFFIC, SUM(TEMP0.TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM(
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.DIA.FIN = ) TEMP0 GROUP BY (TEMP0.SUBAPLICACION_ID) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE 
SQL.DETALLE.DISTRIBUCION.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(UP_TRAFFIC) AS UPLINK_TRAFFIC, SUM(DOWN_TRAFFIC) AS DOWNLINK_TRAFFIC, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY SUBAPLICACION_ID 
# ---------------------------------------------------------
#SQL.DETALLE.ANCHO.BANDA.APLICACION.DIA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY') AS FECHA_DIA FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (APLICACION_ID, FECHA_HORA) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.APLICACION.DIA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY') AS FECHA_DIA FROM ( 
SQL.DETALLE.ANCHO.BANDA.APLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID, FECHA_HORA)

#SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.DIA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY') AS FECHA_DIA FROM ( SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (SUBAPLICACION_ID, FECHA_HORA) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.DIA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY') AS FECHA_DIA FROM ( 
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA)

#SQL.DETALLE.ANCHO.BANDA.APLICACION.HORA = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY HH24') AS FECHA_DIA FROM ( SELECT APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (APLICACION_ID, FECHA_HORA_QRY) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.APLICACION.HORA.INI = SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY HH24') AS FECHA_DIA FROM ( 
SQL.DETALLE.ANCHO.BANDA.APLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID, FECHA_HORA_QRY)
SQL.DETALLE.ANCHO.BANDA.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY (APLICACION_ID, FECHA_HORA_QRY)

#SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.HORA = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY HH24') AS FECHA_DIA FROM ( SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.HORA.INI = SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL_TRAFFIC, TEMPB.TIME_CONEXION, TEMPB.FECHA_DIA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC, TEMPA.TIME_CONEXION, TO_CHAR(TEMPA.FECHA, 'DD-MM-YYYY HH24') AS FECHA_DIA FROM ( 
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA ASC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL_TRAFFIC >= T1.LIMITE
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY) 
SQL.DETALLE.ANCHO.BANDA.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, SUM(TIME_CONEXION) AS TIME_CONEXION, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY)
# ---------------------------------------------------------
#SQL.REPORTE.APLICACION.HORA = SELECT * FROM (SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL,  TO_CHAR(TEMPA.FECHA_HORA, 'DD/MM/YYYY HH24') AS FECHA_HORA FROM ( SELECT APLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC, TEMPA.TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA_HORA ASC, TEMPX.TOTAL DESC
#SQL.REPORTE.SUBAPLICACION.HORA = SELECT * FROM (SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA_HORA, 'DD/MM/YYYY HH24') AS FECHA_HORA FROM ( SELECT SUBAPLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE FECHA_HORA_QRY BETWEEN :fechaInicio AND :fechaFin AND ISDN = :isdn ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_HORA ASC, TEMPA.TOTAL_TRAFFIC DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA_HORA ASC, TEMPX.TOTAL DESC
#SQL.DETALLE.REPORTE.APLICACION.HORA = SELECT * FROM (SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL,  TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY HH24') AS FECHA_HORA FROM ( SELECT APLICACION_ID AS APLICACION_ID,  SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (APLICACION_ID, FECHA_HORA_QRY) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA_HORA ASC, TEMPX.TOTAL DESC
#SQL.DETALLE.REPORTE.SUBAPLICACION.HORA = SELECT * FROM (SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY HH24') AS FECHA_HORA FROM ( SELECT SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC)  AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = :msisdn AND FECHA_HORA_QRY BETWEEN :fechaDetalleInicio AND :fechaDetalleFin GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY) ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA_HORA ASC, TEMPX.TOTAL DESC

# ----------------------------- GET CONSUMO POR HORA ------------------------------
SQL.REPORTE.APLICACION.HORA.INI = SELECT * FROM (SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA, TEMPB.FECHA_HORA1 FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA_HORA, 'DD/MM/YYYY HH24') AS FECHA_HORA, TEMPA.FECHA_HORA1 FROM (
SQL.REPORTE.APLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_HORA1 ASC, TEMPA.TOTAL_TRAFFIC DESC ) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE ) TEMPX ORDER BY TEMPX.FECHA_HORA1 ASC, TEMPX.TOTAL DESC
SQL.REPORTE.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA, FECHA_HORA_QRY AS FECHA_HORA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA]
SQL.REPORTE.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA, FECHA_HORA_QRY AS FECHA_HORA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA]

SQL.DETALLE.REPORTE.APLICACION.HORA.INI = SELECT * FROM (SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA, TEMPB.FECHA1 FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY HH24') AS FECHA_HORA, TEMPA.FECHA1 FROM (
SQL.DETALLE.REPORTE.APLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA1 ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA1 ASC, TEMPX.TOTAL DESC
SQL.DETALLE.REPORTE.APLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID,  SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA, FECHA_HORA_QRY AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID, FECHA_HORA_QRY)
SQL.DETALLE.REPORTE.APLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID,  SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA, FECHA_HORA_QRY AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY (APLICACION_ID, FECHA_HORA_QRY)

SQL.REPORTE.SUBAPLICACION.HORA.INI = SELECT * FROM (SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA, TEMPB.FECHA_HORA1 FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA_HORA, 'DD/MM/YYYY HH24') AS FECHA_HORA, TEMPA.FECHA_HORA1 FROM (
SQL.REPORTE.SUBAPLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_HORA1 ASC, TEMPA.TOTAL_TRAFFIC DESC ) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE ) TEMPX ORDER BY TEMPX.FECHA_HORA1 ASC, TEMPX.TOTAL DESC
SQL.REPORTE.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA, FECHA_HORA_QRY AS FECHA_HORA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA]
SQL.REPORTE.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA_HORA, FECHA_HORA_QRY AS FECHA_HORA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_HORA WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA]

SQL.DETALLE.REPORTE.SUBAPLICACION.HORA.INI = SELECT * FROM (SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_HORA, TEMPB.FECHA1 FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY HH24') AS FECHA_HORA, TEMPA.FECHA1 FROM (
SQL.DETALLE.REPORTE.SUBAPLICACION.HORA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA1 ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA1 ASC, TEMPX.TOTAL DESC
SQL.DETALLE.REPORTE.SUBAPLICACION.HORA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC)  AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA, FECHA_HORA_QRY AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY)
SQL.DETALLE.REPORTE.SUBAPLICACION.HORA.FECHA.HORA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC)  AS TOTAL_TRAFFIC, FECHA_HORA_QRY AS FECHA, FECHA_HORA_QRY AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] AND HORA = [HORA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA_QRY)

#---
SQL.REPORTE.APLICACION.DIA.INI = SELECT * FROM ( SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_DIA, TEMPB.FECHA_DIA1 FROM ( SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA_DIA, 'DD/MM/YYYY') AS FECHA_DIA , TEMPA.FECHA_DIA1 FROM ( 
SQL.REPORTE.APLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA_DIA1 ASC, TEMPA.TOTAL_TRAFFIC DESC ) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE ) TEMPX ORDER BY TEMPX.FECHA_DIA1 ASC, TEMPX.TOTAL DESC
SQL.REPORTE.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ APLICACION_ID, SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, FECHA_DIA, FECHA_DIA AS FECHA_DIA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA] GROUP BY (APLICACION_ID, FECHA_DIA)

SQL.REPORTE.SUBAPLICACION.DIA.INI = SELECT * FROM ( SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_DIA, TEMPB.FECHA_DIA1 FROM ( SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA_DIA, 'DD/MM/YYYY') AS FECHA_DIA, TEMPA.FECHA_DIA1 FROM ( 
SQL.REPORTE.SUBAPLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA_DIA1 ASC, TEMPA.TOTAL_TRAFFIC DESC ) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE ) TEMPX ORDER BY TEMPX.FECHA_DIA1 ASC, TEMPX.TOTAL DESC
SQL.REPORTE.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_SUBAPLICACION_HORA INDX_DN_SUBAPLICACION_HORA) */ SUBAPLICACION_ID, TOTAL_TRAFFIC, FECHA_DIA, FECHA_DIA AS FECHA_DIA1 FROM DETALLE_NAVEGACION.DN_SUBAPLICACION_DIA WHERE ISDN = [ISDN] AND FECHA_DIA = [FECHA]

SQL.DETALLE.REPORTE.APLICACION.DIA.INI = SELECT * FROM (SELECT TEMPB.APLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_DIA, TEMPB.FECHA1 FROM (SELECT TEMPA.APLICACION_ID, DN_APLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY') AS FECHA_DIA, TEMPA.FECHA1 FROM (
SQL.DETALLE.REPORTE.APLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION ON TEMPA.APLICACION_ID = DN_APLICACION.APLICACION_ID ORDER BY TEMPA.FECHA1 ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_APLICACION_COMERCIAL T1 ON TEMPB.APLICACION_ID=T1.ID_APLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA1 ASC, TEMPX.TOTAL DESC
SQL.DETALLE.REPORTE.APLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ APLICACION_ID AS APLICACION_ID,  SUM(TOTAL_TRAFFIC) AS TOTAL_TRAFFIC, FECHA_HORA AS FECHA, FECHA_HORA AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (APLICACION_ID, FECHA_HORA)

SQL.DETALLE.REPORTE.SUBAPLICACION.DIA.INI = SELECT * FROM (SELECT TEMPB.SUBAPLICACION_ID, (CASE WHEN T1.NOMBRE_COMERCIAL IS NULL THEN TEMPB.NOMBRE ELSE T1.NOMBRE_COMERCIAL END) AS NOMBRE, TEMPB.TOTAL, TEMPB.FECHA_DIA, TEMPB.FECHA1 FROM (SELECT TEMPA.SUBAPLICACION_ID, DN_SUBAPLICACION.NOMBRE, TEMPA.TOTAL_TRAFFIC AS TOTAL, TO_CHAR(TEMPA.FECHA, 'DD/MM/YYYY') AS FECHA_DIA, TEMPA.FECHA1 FROM (
SQL.DETALLE.REPORTE.SUBAPLICACION.DIA.FIN = ) TEMPA LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION ON TEMPA.SUBAPLICACION_ID = DN_SUBAPLICACION.SUBAPLICACION_ID ORDER BY TEMPA.FECHA1 ASC, TOTAL DESC) TEMPB LEFT JOIN DETALLE_NAVEGACION.DN_SUBAPLICACION_COMERCIAL T1 ON TEMPB.SUBAPLICACION_ID=T1.ID_SUBAPLICACION AND T1.ESTADO=1 WHERE T1.VISIBLE = 1 OR T1.VISIBLE IS NULL OR TEMPB.TOTAL >= T1.LIMITE) TEMPX ORDER BY TEMPX.FECHA1 ASC, TEMPX.TOTAL DESC
SQL.DETALLE.REPORTE.SUBAPLICACION.DIA.FECHA = SELECT /*+ INDEX (DN_DETALLE INDX1_DN_DETALLE_ISDN) */ SUBAPLICACION_ID AS SUBAPLICACION_ID, SUM(TOTAL_TRAFFIC)  AS TOTAL_TRAFFIC, FECHA_HORA AS FECHA, FECHA_HORA AS FECHA1 FROM DETALLE_NAVEGACION.DN_DETALLE WHERE ISDN = [ISDN] AND FECHA_HORA = [FECHA] GROUP BY (SUBAPLICACION_ID, FECHA_HORA)